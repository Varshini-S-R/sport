<!DOCTYPE html>
<html>
<head>
<title>Edit Player Information</title>
<meta charset="UTF-8">

<style>
body {
    font-family: Arial;
    background: #c2f7c2;
    padding: 20px;
}
.container {
    background: white;
    padding: 20px;
    border-radius: 10px;
    width: 350px;
    margin: auto;
    box-shadow: 0px 0px 10px #0003;
}
input, select {
    width: 100%;
    padding: 12px;
    margin: 8px 0;
    border-radius: 8px;
    border: 1px solid #555;
}
button {
    width: 100%;
    padding: 12px;
    margin-top: 10px;
    background: green;
    color: white;
    border: none;
    font-size: 18px;
    border-radius: 8px;
    cursor: pointer;
}
</style>
</head>

<body>

<h1 style="text-align:center;">Edit Player Details</h1>

<div class="container">

    <label>Select Player</label>
    <select id="playerSelect" onchange="loadPlayer()">
        <option value="">-- Select Player --</option>
    </select>

    <label>Name</label>
    <input type="text" id="name">

    <label>Age</label>
    <input type="number" id="age">

    <label>Team</label>
    <input type="text" id="team">

    <label>Role</label>
    <input type="text" id="role">

    <label>Phone</label>
    <input type="text" id="phone">

    <button onclick="updatePlayer()">Save Changes</button>
</div>

<script>
const BIN_ID = "6921e288ae596e708f69e82b";
const API_KEY = "$2a$10$F8LDQjZ9qzvGczlmC5/J2ekZLpGVvQnj0nSgt02RoA6n6HsQ3pZEK";

let players = [];

/* --------------------------------
   LOAD PLAYER LIST ON PAGE LOAD
-------------------------------- */
window.onload = async () => {
    let res = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`, {
        headers: { "X-Master-Key": API_KEY }
    });

    let data = await res.json();
    players = data.record.players || [];

    let select = document.getElementById("playerSelect");
    players.forEach((p, index) => {
        let opt = document.createElement("option");
        opt.value = index;
        opt.textContent = p.name;
        select.appendChild(opt);
    });
};

/* --------------------------------
      LOAD PLAYER INFO
-------------------------------- */
function loadPlayer() {
    let index = document.getElementById("playerSelect").value;
    if (index === "") return;

    let p = players[index];

    document.getElementById("name").value = p.name;
    document.getElementById("age").value = p.age;
    document.getElementById("team").value = p.team;
    document.getElementById("role").value = p.role;
    document.getElementById("phone").value = p.phone;
}

/* --------------------------------
         UPDATE PLAYER
-------------------------------- */
async function updatePlayer() {
    let index = document.getElementById("playerSelect").value;

    if (index === "") {
        alert("Please select a player to update!");
        return;
    }

    // Update selected player's info
    players[index] = {
        name: document.getElementById("name").value,
        age: document.getElementById("age").value,
        team: document.getElementById("team").value,
        role: document.getElementById("role").value,
        phone: document.getElementById("phone").value
    };

    // Save back to JSONBin
    await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}`, {
        method: "PUT",
        headers: {
            "Content-Type": "application/json",
            "X-Master-Key": API_KEY
        },
        body: JSON.stringify({ players })
    });

    alert("Player details updated successfully!");
}
</script>

</body>
</html>
